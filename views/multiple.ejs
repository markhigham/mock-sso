<!DOCTYPE html>
<html lang="en" class="govuk-template ">

<head>
    <meta charset="utf-8">
    <title>mock-sso - don't use in prod</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0b0c0c">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="shortcut icon" sizes="16x16 32x32 48x48" href="/assets/images/favicon.ico" type="image/x-icon">
    <link rel="mask-icon" href="/assets/images/govuk-mask-icon.svg" color="#0b0c0c">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/govuk-apple-touch-icon-180x180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/assets/images/govuk-apple-touch-icon-167x167.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/images/govuk-apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" href="/assets/images/govuk-apple-touch-icon.png">

    <!--[if !IE 8]><!-->
    <link href="/css/main.css" rel="stylesheet">
    <!--<![endif]-->

    <meta property="og:image" content="/assets/images/govuk-opengraph-image.png">
</head>

<body class="govuk-template__body ">
<script>
  document.body.className = ((document.body.className) ? document.body.className + " js-enabled" : "js-enabled");

  function remove(emailUserId, email) {
    if (!confirm(`Delete ${email}`)) return;
    setFormEmailUserId(emailUserId);
    const button = document.getElementById("removeButton");
    button.click();
  }

  function setFormEmailUserId(emailUserId) {
    const form = document.getElementById("loginForm");
    const emailInput = document.getElementById("emailUserId");
    emailInput.value = emailUserId;
    return form;
  }

  function login(emailUserId) {
    const form = setFormEmailUserId(emailUserId);
    form.submit();
  }

</script>

<a href="#main-content" class="govuk-skip-link">Skip to main content</a>

<header class="govuk-header " role="banner" data-module="govuk-header">
    <div class="govuk-header__container govuk-width-container">
        <div class="govuk-header__logo">
            <a href="/" class="govuk-header__link govuk-header__link--homepage">
          <span class="govuk-header__logotype">

            <span class="govuk-header__logotype-text">
              mock-sso
            </span>
          </span>
            </a>
        </div>
    </div>
</header>

<div class="govuk-width-container ">
    <main class="govuk-main-wrapper " id="main-content" role="main">
        <% if (users.length){ %>
            <h1 class="govuk-heading-l">Login as an existing user</h1>


            <form id="loginForm" method="post" action="/select-user" style="display:none;">
                <input type="text" value="<%= redirectUri; %>" name="redirectUri" />
                <input type="text" name="email_user_id" id="emailUserId" />
                <button type="submit" name="submit_button" value="remove-user" id="removeButton">Remove</button>
            </form>

            <div class="govuk-grid-row govuk-!-margin-bottom-8">
                <div class="govuk-grid-column-full">
                    <div style="max-height: 30rem;overflow-y:scroll;">
                        <dl class="govuk-summary-list">
                            <% users.forEach(function(user) { %>
                                <div class="govuk-summary-list__row">
                                    <dt class="govuk-summary-list__key">
                                        <a
                                                onclick="login('<%= user.email_user_id %>')"
                                                class="govuk-link__fake" style="font-weight: bold;">
                                            <%= user.first_name; %> <%= user.last_name %>
                                        </a>

                                    </dt>

                                    <dd class="govuk-summary-list__value">
                                        <%= user.email %>
                                    </dd>


                                    <dd class="govuk-summary-list__actions">

                                        <a class="govuk-link__fake"
                                           onclick="remove('<%= user.email_user_id %>', '<%= user.email %>')">Remove</a>

                                    </dd>

                                </div>
                            <% }); %>
                        </dl>
                    </div>
                </div>
            </div>
        <% } %>
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-two-thirds">
                <h2 class="govuk-heading-l">Login as a new user</h2>

                <form action="/create-user" method="post">
                    <div class="govuk-grid-row">
                        <div class="govuk-grid-column-one-half">
                            <div class="govuk-form-group">
                                <label class="govuk-label" for="first_name">First name</label>
                                <input type="text" class="govuk-input" id="first_name" name="first_name" required />
                            </div>
                        </div>
                        <div class="govuk-grid-column-one-half">
                            <div class="govuk-form-group">
                                <label class="govuk-label" for="last_name">Last name</label>
                                <input type="text" class="govuk-input" id="last_name" name="last_name" required />
                            </div>
                        </div>
                    </div>
                    <div class="govuk-form-group">
                        <label class="govuk-label" for="email">Email</label>
                        <input type="email" class="govuk-input govuk-input--width-20" id="email" name="email"
                               required />
                    </div>
                    <div class="govuk-form-group">
                        <input type="hidden" value="<%= redirectUri; %>" name="redirectUri" />
                        <input type="submit" class="govuk-button" value="Create and login" />
                    </div>
                </form>
            </div>
        </div>

    </main>
</div>

<footer class="govuk-footer " role="contentinfo">
    <div class="govuk-width-container ">
        <div class="govuk-footer__meta">
            <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">
                <span class="govuk-footer__licence-description">
             <%= title %> <%= version %> - <%= repo %>

          </span>
            </div>
        </div>
    </div>
</footer>

<script src="/js/all.js"></script>
<script>
  window.GOVUKFrontend.initAll();

</script>
</body>

</html>


